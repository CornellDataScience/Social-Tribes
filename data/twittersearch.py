import requests
import webbrowser
import twitter
import json
import time


api = twitter.Api(
	consumer_key='l9Q0w7nK3JeVA7pKNwGTb7V5n',
	consumer_secret='bxWh7ErvtvECOKTmqqpq5QnXqO29pXI6iC5QDNDpCSzBnZJZbV',
	access_token_key='974302735196737536-QJJzY3vtj1FNA43AXz5FnhKzV8KiApo',
	access_token_secret='Je1wyAYaLIITcSSQOIto8BiW4oESfmCdv4lVqHIJROYLb')



# results = api.GetListMembers(slug="political-journalists", owner_screen_name="mattklewis")

# mresults = [user._json for user in results]
# with open('political-journalists.json', 'w') as outfile:
#     json.dump(mresults, outfile)

# ids = [user.id for user in results]

# with open('political-journalists-connections.json', 'w') as outfile:
# 		json.dump({}, outfile)

ids = [2740274906, 1123285472, 997684836, 620618811, 463028527, 448295627, 426802833, 407013776, 398088661, 373791638, 360080772, 346197350, 326255267, 322143316, 314837545, 309937733, 309877044, 309282144, 308233424, 295361142, 294270520, 293303534, 292549803, 282545479, 275207082, 272549524, 269448653, 266830495, 259395895, 258885469, 257661436, 255347566, 254036748, 251627765, 250784170, 245220581, 243840731, 243639047, 243337600, 242944499, 242418441, 241201385, 240014188, 237477771, 236026761, 233970489, 230450027, 227841653, 227373977, 225123568, 224320485, 222622640, 222554961, 219350591, 218952383, 218325695, 217550862, 213713264, 210862000, 206487352, 201790336, 199836680, 191589342, 191477653, 185360823, 184860130, 184136149, 179588796, 173925279, 169627574, 169596992, 169586280, 169586059, 168506048, 168295477, 165998897, 163995093, 163598915, 163589845, 161044052, 159609655, 159586103, 158565222, 153181367, 151444950, 147649517, 146917197, 142490217, 140896427, 140286364, 138479037, 137466464, 136550204, 136300373, 135515077, 131630960, 130945778, 129997410, 128659076, 126722715, 126629610, 126369849, 123327472, 122396513, 121795745, 119491006, 119099920, 118188665, 117809503, 117419826, 117188363, 115564212, 114050808, 112526560, 109446583, 108985543, 108686283, 108617810, 106135104, 105187267, 104299137, 103949895, 103447346, 103087786, 102789488, 102238997, 98543618, 97474887, 96405362, 93876666, 93069110, 92079350, 89220865, 87584353, 87498687, 87063281, 86129724, 85849661, 85131054, 83462293, 82643763, 80638910, 80617430, 80111587, 79743108, 78716886, 77032777, 76601805, 76133715, 75600769, 74820061, 74241914, 72473481, 70511174, 69181624, 68801460, 65159344, 64916983, 61127668, 61090009, 59676104, 59425403, 59331128, 58942338, 57770539, 56223278, 55394190, 55370790, 54622050, 52774637, 52112689, 52070270, 50325797, 50073507, 49620730, 48581849, 48388417, 48038024, 47632905, 47498801, 47448886, 47415772, 46955476, 46817943, 46746151, 46737822, 46662081, 46582653, 46557945, 46479416, 46176168, 45399148, 44960116, 43945628, 43581352, 43409523, 41387157, 39279393, 39155029, 38496530, 37917164, 37718165, 36890646, 36510873, 36406587, 36366822, 36260866, 35474809, 35187768, 35123052, 35027698, 34036358, 34022952, 33919343, 33222598, 32521584, 31534918, 31464192, 31127446, 30948168, 30513693, 29610739, 29263488, 29244617, 28902856, 28676476, 28332786, 28181835, 28113052, 28049266, 27948604, 27882000, 27676108, 27511061, 26754354, 26538676, 26513860, 26283307, 26178536, 26133429, 25458129, 24703826, 24464743, 24439201, 24190226, 24112504, 23911915, 23849615, 23817772, 23768237, 23621827, 23563830, 23455653, 22978395, 22772264, 22771961, 22675685, 22313347, 22138357, 21878635, 21845498, 21842781, 21800063, 21787198, 21768766, 21612122, 21443773, 21431618, 21316253, 21313053, 21307076, 21306875, 21252618, 21251668, 21220931, 21144314, 21027715, 20957491, 20815668, 20776497, 20522862, 20474813, 20295222, 20031243, 19914257, 19629840, 19608273, 19419870, 19371141, 19354391, 19195094, 19193016, 19107878, 19082018, 19077617, 18993104, 18963809, 18909534, 18825339, 18780213, 18776942, 18772897, 18678924, 18646108, 18637396, 18172905, 18097821, 18028893, 17910554, 17881467, 17824322, 17759597, 17751265, 17746914, 17637692, 17060020, 17044233, 16960812, 16930125, 16898332, 16887628, 16555985, 16459325, 16434868, 16399949, 16371887, 16359843, 16353245, 16252199, 16250929, 16194566, 16187637, 16157855, 16125224, 16097702, 16081831, 16072058, 16017475, 15988710, 15931637, 15901113, 15896464, 15892011, 15891430, 15837659, 15815453, 15731368, 15724082, 15670644, 15650573, 15633728, 15606793, 15463486, 15433452, 15399512, 15359578, 15335534, 15334380, 15320603, 15234546, 15212187, 15210284, 15159913, 15145995, 14962779, 14940354, 14884201, 14870670, 14790314, 14716058, 14560097, 14552725, 14529929, 14465607, 14434063, 14413466, 14412533, 14270650, 14268812, 14246001, 14245722, 14213413, 14059338, 14049145, 14007532, 13524182, 12926172, 12670512, 12654802, 12354832, 12340562, 12272322, 11771512, 11680962, 10943662, 9532402, 9252212, 8732322, 8565452, 7848802, 7819802, 7140202, 6904552, 6332292, 5336752, 2020351, 1025521, 754485]


for i in ids:
	follower_cursor = -1
	friend_cursor = -1
	afollowers = []
	afriends = []

	while friend_cursor != 0:
		try:
			friend_cursor, previous_friend_cursor, pagedfriends = api.GetFriendsPaged(user_id=i, cursor=friend_cursor, count=200, skip_status=False, include_user_entities=True)
			afriends.extend([friend._json for friend in pagedfriends])
		except twitter.TwitterError:
			print("Waiting for " + str(i) + " friends ...")
			time.sleep(900)
	print("Friends for " + str(i) + " found")

	while follower_cursor != 0:
		try:
			follower_cursor, previous_follower_cursor, pagedfollowers = api.GetFollowersPaged(user_id=i, cursor=follower_cursor, count=200, skip_status=False, include_user_entities=True)
			afollowers.extend([follower._json for follower in pagedfollowers])
		except twitter.TwitterError:
			print("Waiting for " + str(i) + " followers ...")
			time.sleep(900)

	print("Friends for " + str(i) + " found")

	bundle = {"followers": afollowers, "friends": afriends}
	with open('political-journalists-connections.json', mode='r') as infile:
		connections = json.load(infile)
	with open('political-journalists-connections.json', 'w') as outfile:
		connections[i] = bundle
		json.dump(connections, outfile)

